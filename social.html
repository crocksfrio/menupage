<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social TV - Crocks Frio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Importação dos arquivos de dados -->
    <script src="social-config.js"></script>
    <script src="reviews.js"></script>

    <style>
        body { font-family: 'Nunito', sans-serif; background: #f0f2f5; overflow: hidden; height: 100vh; margin: 0; display: flex; }
        .font-display { font-family: 'Fredoka', sans-serif; }
        
        .video-container { width: 40%; height: 100vh; background: #000; display: flex; align-items: center; justify-content: center; box-shadow: 5px 0 15px rgba(0,0,0,0.1); z-index: 10; }
        video { height: 100%; width: 100%; object-fit: cover; }

        .content-container { width: 60%; height: 100vh; padding: 30px; display: flex; flex-direction: column; justify-content: space-between; background: white; }

        .review-card { background: #fff; padding: 16px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; margin-bottom: 12px; animation: slideUp 0.6s ease-out forwards; opacity: 0; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .fade-in { animation: fadeIn 0.6s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .progress-bar { width: 100%; height: 6px; background: #eee; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #14b8a6; width: 0%; transition: width linear; }
    </style>
</head>
<body>

    <div class="video-container">
        <video id="player" muted playsinline></video>
    </div>

    <div class="content-container">
        <!-- Header -->
        <div class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-4xl font-display font-bold text-teal-600">Crocks Frio</h1>
                <p class="text-gray-400 text-[10px] font-bold uppercase tracking-tighter">Experiências que encantam</p>
        <!-- Conteúdo -->
        <div id="dynamic-area" class="flex-grow flex flex-col justify-center"></div>

        <!-- Footer -->
        <div class="border-t pt-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-pink-500 rounded-xl flex items-center justify-center text-white text-lg"><i class="fab fa-instagram"></i></div>
                <div>
                    <p class="text-gray-400 text-[10px] font-bold uppercase">Siga a gente</p>
                    <p class="text-xl font-black text-gray-800" id="insta-tag">@carregando</p>
                </div>
            </div>
            <div class="flex flex-col items-end">
                <div class="progress-bar w-32 mb-1"><div id="p-fill" class="progress-fill"></div></div>
                <p class="text-[8px] font-bold text-gray-300 uppercase">Próximo conteúdo</p>
            </div>
        </div>
    </div>

    <script>
        let vIdx = 0;
        let sIdx = 0;
        const player = document.getElementById('player');
        const area = document.getElementById('dynamic-area');
        const pFill = document.getElementById('p-fill');

        function start() {
            document.getElementById('insta-tag').innerText = SOCIAL_CONFIG.instagram.handle;
            playVideo();
            update();
            setInterval(update, SOCIAL_CONFIG.tempoSlideAvaliacao);
        }

        function playVideo() {
            if (!SOCIAL_CONFIG.videos.length) return;
            player.src = SOCIAL_CONFIG.videos[vIdx];
            player.play().catch(() => {});
            vIdx = (vIdx + 1) % SOCIAL_CONFIG.videos.length;
        }
        player.onended = playVideo;

        function update() {
            let html = '';
            if (sIdx === 0) {
                // Sorteia 3 avaliações do arquivo reviews.js
                const pool = (typeof GOOGLE_REVIEWS_DATA !== 'undefined') ? GOOGLE_REVIEWS_DATA : [];
                const selection = [...pool].sort(() => 0.5 - Math.random()).slice(0, 3);

                html = `<div class="fade-in"><h2 class="text-lg font-bold text-gray-700 uppercase mb-4 flex items-center gap-2"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg" width="16"> Clientes no Google</h2><div class="space-y-2">`;
                selection.forEach((r, i) => {
                    let stars = ''; for(let j=0; j<5; j++) stars += `<i class="fas fa-star ${j < r.estrelas ? 'text-yellow-400' : 'text-gray-200'} text-[10px]"></i>`;
                    const avatar = `https://ui-avatars.com/api/?name=${encodeURIComponent(r.nome)}&background=random&color=fff&size=80`;
                    html += `<div class="review-card" style="animation-delay:${i*0.2}s"><div class="flex justify-between items-center mb-1"><div class="flex items-center gap-2"><img src="${avatar}" class="w-8 h-8 rounded-full"><span class="font-black text-xs uppercase">${r.nome}</span></div><div>${stars}</div></div><p class="text-gray-600 text-sm italic leading-tight">"${r.texto}"</p></div>`;
                });
                html += `</div></div>`;
            } else {
                const isInsta = sIdx === 1;
                const link = isInsta ? SOCIAL_CONFIG.instagram.link : SOCIAL_CONFIG.googleReviewLink;
                const title = isInsta ? "Nosso Instagram" : "Dê sua Nota";
                const icon = isInsta ? "fab fa-instagram text-pink-500" : "fab fa-google text-blue-500";
                html = `<div class="fade-in flex flex-col items-center text-center"><div class="text-4xl mb-2 ${icon}"></div><h2 class="text-3xl font-display font-bold text-gray-800 mb-1">${title}</h2><p class="text-xs text-gray-400 mb-4 uppercase font-bold">Escaneie para interagir</p><div class="bg-white p-4 rounded-[30px] shadow-lg border-4 border-gray-50"><img src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(link)}" class="w-48 h-48"></div></div>`;
            }

            area.innerHTML = html;
            pFill.style.transition = 'none'; pFill.style.width = '0%';
            setTimeout(() => { pFill.style.transition = `width ${SOCIAL_CONFIG.tempoSlideAvaliacao}ms linear`; pFill.style.width = '100%'; }, 50);
            sIdx = (sIdx + 1) % 3;
        }

        window.onload = start;
    </script>
</body>
</html>